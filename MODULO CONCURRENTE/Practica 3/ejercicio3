programa ejercicio3
procesos
  proceso juntarFlor(ES flores: numero)
  comenzar
    si(HayFlorEnLaEsquina)
      tomarFlor
      flores:= flores + 1
      EnviarMensaje(1, robot5)
    sino
      EnviarMensaje(2,robot5)    
  fin
areas
  areaJefe : AreaP(1,1,1,1)
  areaRecolectores : AreaPC(2,2,10,10)
  areaRobot1 : AreaP(2,1,2,1)
  areaRobot2 : AreaP(3,1,3,1)
  areaRobot3 : AreaP(4,1,4,1)
  areaRobot4 : AreaP(5,1,5,1)
robots
  robot recolector
  variables
    quien, avenidaInicio, calleInicio, flores, estado, avenidaRandom, calleRandom: numero
  comenzar
    flores:= 0
    avenidaInicio:= PosAv
    calleInicio:= PosCa
    RecibirMensaje(quien, robot5)
    RecibirMensaje(avenidaRandom, robot5)
    RecibirMensaje(calleRandom, robot5)
    RecibirMensaje(estado, robot5)
    mientras(estado = 1)
      BloquearEsquina(avenidaRandom, calleRandom)
      Pos(avenidaRandom, calleRandom)
      juntarFlor(flores)
      Pos(avenidaInicio, calleInicio)
      LiberarEsquina(avenidaRandom, calleRandom)
      RecibirMensaje(estado, robot5)
    EnviarMensaje(quien, robot5)  
    EnviarMensaje(flores, robot5)  
  fin
  robot jefe
  variables
    numRobot, avenidaRandom, calleRandom, estado, cantTotal, max, robotMax: numero 
  comenzar
    max:= 0
    estado:= 1
    EnviarMensaje(1, robot1)
    EnviarMensaje(2, robot2)
    EnviarMensaje(3, robot3)
    EnviarMensaje(4, robot4)
    Random(avenidaRandom, 2, 10)
    Random(calleRandom, 2, 10)
    EnviarMensaje(avenidaRandom, robot1)
    EnviarMensaje(calleRandom, robot1)
    EnviarMensaje(avenidaRandom, robot2)
    EnviarMensaje(calleRandom, robot2)
    EnviarMensaje(avenidaRandom, robot3)
    EnviarMensaje(calleRandom, robot3)
    EnviarMensaje(avenidaRandom, robot4)
    EnviarMensaje(calleRandom, robot4)    
    mientras(estado = 1)
      Random(numRobot, 1, 4)
      si(numRobot = 1)
        EnviarMensaje(1, robot1)
      sino
        si(numRobot = 2)
          EnviarMensaje(1, robot2)
        sino
          si(numRobot = 3)
            EnviarMensaje(1, robot3)
          sino
            EnviarMensaje(1, robot4)
      RecibirMensaje(estado, *)
    EnviarMensaje(2, robot1)
    EnviarMensaje(2, robot2)
    EnviarMensaje(2, robot3)
    EnviarMensaje(2, robot4) 
    repetir 4
      RecibirMensaje(numRobot, *)
      si(numRobot = 1)
        RecibirMensaje(cantTotal, robot1)
      sino
        si(numRobot = 2)
          RecibirMensaje(cantTotal, robot2)
        sino
          si(numRobot = 3)
            RecibirMensaje(cantTotal, robot3)
          sino
            RecibirMensaje(cantTotal, robot4)
      si(cantTotal > max)
        max:= cantTotal
        robotMax:= numRobot
    Informar(robotMax)  
  fin
variables
  robot1: recolector
  robot2: recolector
  robot3: recolector
  robot4: recolector
  robot5: jefe
comenzar
  AsignarArea(robot1, areaRecolectores)
  AsignarArea(robot1, areaRobot1)
  AsignarArea(robot2, areaRecolectores)
  AsignarArea(robot2, areaRobot2)
  AsignarArea(robot3, areaRecolectores)
  AsignarArea(robot3, areaRobot3)
  AsignarArea(robot4, areaRecolectores)
  AsignarArea(robot4, areaRobot4)
  AsignarArea(robot5, areaJefe)
  Iniciar(robot1, 2,1)
  Iniciar(robot2, 3,1)
  Iniciar(robot3, 4,1)
  Iniciar(robot4, 5,1)
  Iniciar(robot5, 1,1)
fin  